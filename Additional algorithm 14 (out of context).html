<!-- ############################################################################################################################## -->
<!-- #  John Wiley & Sons, Inc.                                                                                                   # -->
<!-- #                                                                                                                            # -->
<!-- #  Book:   Algorithms in Bioinformatics: Theory and Implementation                                                           # -->
<!-- #  Author: Dr. Paul A. Gagniuc                                                                                               # -->
<!-- #                                                                                                                            # -->
<!-- #  Institution:                                                                                                              # -->
<!-- #    University Politehnica of Bucharest                                                                                     # -->
<!-- #    Faculty of Engineering in Foreign Languages                                                                             # -->
<!-- #    Department of Engineering in Foreign Languages                                                                          # -->
<!-- #                                                                                                                            # -->
<!-- #  Area:   European Union                                                                                                    # -->
<!-- #  Date:   04/01/2021                                                                                                        # -->
<!-- #                                                                                                                            # -->
<!-- #  Cite this work as:                                                                                                        # -->
<!-- #    Paul A. Gagniuc. Algorithms in Bioinformatics: Theory and Implementation. John Wiley & Sons, 2021, ISBN: 9781119697961. # -->
<!-- #                                                                                                                            # -->
<!-- ############################################################################################################################## -->

<script>

var AlignmentA = "";
var AlignmentM = "";
var AlignmentB = "";

var i = n_0;
var j = n_1;

while (i>=2 || j>=2) {

    var Ai = m[i][0];
    var Bj = m[0][j];

    if(i>=2 && j>=2 && m[i][j]==m[i-1][j-1] + f(Ai, Bj)) {

        AlignmentA = Ai + AlignmentA;
        AlignmentB = Bj + AlignmentB;

        if(Ai==Bj){
            AlignmentM = '|' + AlignmentM;
        } else {
            AlignmentM = '&emsp;' + AlignmentM;
        }

        i = i - 1;
        j = j - 1;

    } else {
        
        if(i>=2 && m[i][j]==m[i-1][j] + gap) {

            AlignmentA = Ai + AlignmentA;
            AlignmentB = '-' + AlignmentB;
            AlignmentM = '&emsp;' + AlignmentM;

            i = i - 1;

        } else {
            
            AlignmentA = '-' + AlignmentA;
            AlignmentB = Bj + AlignmentB;
            AlignmentM = '&emsp;' + AlignmentM;

            j = j - 1;
        }
    }
}

</script>