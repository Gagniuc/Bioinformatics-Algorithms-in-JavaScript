<!-- ############################################################################################################################## -->
<!-- #  John Wiley & Sons, Inc.                                                                                                   # -->
<!-- #                                                                                                                            # -->
<!-- #  Book:   Algorithms in Bioinformatics: Theory and Implementation                                                           # -->
<!-- #  Author: Dr. Paul A. Gagniuc                                                                                               # -->
<!-- #                                                                                                                            # -->
<!-- #  Institution:                                                                                                              # -->
<!-- #    University Politehnica of Bucharest                                                                                     # -->
<!-- #    Faculty of Engineering in Foreign Languages                                                                             # -->
<!-- #    Department of Engineering in Foreign Languages                                                                          # -->
<!-- #                                                                                                                            # -->
<!-- #  Area:   European Union                                                                                                    # -->
<!-- #  Date:   04/01/2021                                                                                                        # -->
<!-- #                                                                                                                            # -->
<!-- #  Cite this work as:                                                                                                        # -->
<!-- #    Paul A. Gagniuc. Algorithms in Bioinformatics: Theory and Implementation. John Wiley & Sons, 2021, ISBN: 9781119697961. # -->
<!-- #                                                                                                                            # -->
<!-- ############################################################################################################################## -->

<script>

// A frequency scanner with a threshold filter
var s = 'CATTAACGGAGCGCGCGCGGTCTCTCT';

var w = 9;
var d = 'CG';

var t = '';
var n = '';
var b = GF(s,d);

document.write('Global CpG% = ' + b);

for (var u=0; u<=s.length-w; u++)
{
    n = s.substr(u,w);
    x = GF(n,d);
    if(x < b){x='-';}
    t += x + ',';
}

document.write('<hr>Signal:<br>' + t);

function GF(s, m)
{
    var p = 0;
    s = s.toLowerCase();
    m = m.toLowerCase();

    p = s.split(m).join('').length;
    p = (s.length - p)/s.length;

    return (p * 100).toFixed(0);
}

</script>
